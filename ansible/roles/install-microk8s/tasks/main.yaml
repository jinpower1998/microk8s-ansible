- name: install microk8s native
  community.general.snap:
    name:
      - microk8s
    classic: true
    channel: "1.32"

- name: enable ufw-rules for cni-networking
  community.general.ufw:
    rule: allow
    interface_in: cni0
    interface_out: cni0
    direction: routedd


- name: show status
  ansible.builtin.shell:
    cmd: microk8s status --wait-ready
  register: out

- debug: var=out.stdout_lines
